<!-- Desktop Sidebar -->
<div
  class="hidden md:flex flex-col bg-gray-950 border-r border-gray-800 shrink-0 transition-all duration-200 ease-in-out"
  [class.w-12]="!sidebarOpen()"
  [class.w-48]="sidebarOpen()">
  <div class="flex items-center h-12 border-b border-gray-800" [class.justify-center]="!sidebarOpen()" [class.px-3]="sidebarOpen()">
    <button
      (click)="onToggleSidebar()"
      class="text-gray-400 hover:text-white hover:bg-gray-800/50 transition-all p-2 rounded"
      [attr.aria-expanded]="sidebarOpen()"
      aria-label="Toggle sidebar panel">
      <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 12h18M3 6h18M3 18h18"></path>
      </svg>
    </button>
    @if (sidebarOpen()) {
      <span class="ml-2 text-xs font-semibold text-gray-400 uppercase tracking-wider whitespace-nowrap overflow-hidden">Explorer</span>
    }
  </div>

  <nav class="flex-1 flex flex-col py-2 gap-1" [class.overflow-y-auto]="sidebarOpen()" aria-label="Main navigation">
    <a
      routerLink="/home"
      routerLinkActive="text-white bg-gray-800 border-l-2 border-brand-primary"
      [routerLinkActiveOptions]="{exact: false}"
      class="w-full flex items-center h-10 text-gray-400 hover:text-white hover:bg-gray-800/50 transition-all relative group"
      [class.justify-center]="!sidebarOpen()"
      [class.px-3]="sidebarOpen()"
      [class.gap-3]="sidebarOpen()"
      aria-label="Home">
      <img class="w-5 h-5 shrink-0" aria-label="Home icon" alt="Home" src="assets/logo_small.webp" />
      @if (sidebarOpen()) {
        <span class="text-sm whitespace-nowrap overflow-hidden">Home</span>
      } @else {
        <span class="absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-50 pointer-events-none">
          Home
        </span>
      }
    </a>

    <a
      routerLink="/csharp-json"
      routerLinkActive="text-white bg-gray-800 border-l-2 border-brand-primary"
      class="w-full flex items-center h-10 text-gray-400 hover:text-white hover:bg-gray-800/50 transition-all relative group"
      [class.justify-center]="!sidebarOpen()"
      [class.px-3]="sidebarOpen()"
      [class.gap-3]="sidebarOpen()"
      aria-label="JSON to C# Converter">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 shrink-0" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M14 19H16C17.1046 19 18 18.1046 18 17V14.5616C18 13.6438 18.6246 12.8439 19.5149 12.6213L21.0299 12.2425C21.2823 12.1794 21.2823 11.8206 21.0299 11.7575L19.5149 11.3787C18.6246 11.1561 18 10.3562 18 9.43845V5H14"/>
        <path d="M10 5H8C6.89543 5 6 5.89543 6 7V9.43845C6 10.3562 5.37541 11.1561 4.48507 11.3787L2.97014 11.7575C2.71765 11.8206 2.71765 12.1794 2.97014 12.2425L4.48507 12.6213C5.37541 12.8439 6 13.6438 6 14.5616V19H10"/>
      </svg>
      @if (sidebarOpen()) {
        <span class="text-sm whitespace-nowrap overflow-hidden">JSON → C#</span>
      } @else {
        <span class="absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-50 pointer-events-none">
          JSON → C#
        </span>
      }
    </a>

    <a
      routerLink="/csharp-typescript"
      routerLinkActive="text-white bg-gray-800 border-l-2 border-brand-primary"
      class="w-full flex items-center h-10 text-gray-400 hover:text-white hover:bg-gray-800/50 transition-all relative group"
      [class.justify-center]="!sidebarOpen()"
      [class.px-3]="sidebarOpen()"
      [class.gap-3]="sidebarOpen()"
      aria-label="C# to TypeScript Converter">
      <svg class="w-5 h-5 shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="16 18 22 12 16 6"></polyline>
        <polyline points="8 6 2 12 8 18"></polyline>
      </svg>
      @if (sidebarOpen()) {
        <span class="text-sm whitespace-nowrap overflow-hidden">C# ↔ TypeScript</span>
      } @else {
        <span class="absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-50 pointer-events-none">
          C# ↔ TypeScript
        </span>
      }
    </a>

    <a
      routerLink="/middleware-designer"
      routerLinkActive="text-white bg-gray-800 border-l-2 border-brand-primary"
      class="w-full flex items-center h-10 text-gray-400 hover:text-white hover:bg-gray-800/50 transition-all relative group"
      [class.justify-center]="!sidebarOpen()"
      [class.px-3]="sidebarOpen()"
      [class.gap-3]="sidebarOpen()"
      aria-label="Middleware Designer">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 6.878V6a2.25 2.25 0 0 1 2.25-2.25h7.5A2.25 2.25 0 0 1 18 6v.878m-12 0c.235-.083.487-.128.75-.128h10.5c.263 0 .515.045.75.128m-12 0A2.25 2.25 0 0 0 4.5 9v.878m13.5-3A2.25 2.25 0 0 1 19.5 9v.878m0 0a2.246 2.246 0 0 0-.75-.128H5.25c-.263 0-.515.045-.75.128m15 0A2.25 2.25 0 0 1 21 12v6a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 18v-6c0-.98.626-1.813 1.5-2.122" />
      </svg>
      @if (sidebarOpen()) {
        <span class="text-sm whitespace-nowrap overflow-hidden">Middleware Designer</span>
      } @else {
        <span class="absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-50 pointer-events-none">
          Middleware Designer
        </span>
      }
    </a>

    <a
      routerLink="/jwt-decoder"
      routerLinkActive="text-white bg-gray-800 border-l-2 border-brand-primary"
      class="w-full flex items-center h-10 text-gray-400 hover:text-white hover:bg-gray-800/50 transition-all relative group"
      [class.justify-center]="!sidebarOpen()"
      [class.px-3]="sidebarOpen()"
      [class.gap-3]="sidebarOpen()"
      aria-label="JWT Decoder">
      <svg class="w-5 h-5 shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
        <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
      </svg>
      @if (sidebarOpen()) {
        <span class="text-sm whitespace-nowrap overflow-hidden">JWT Decoder</span>
      } @else {
        <span class="absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-50 pointer-events-none">
          JWT Decoder
        </span>
      }
    </a>

    <a
      routerLink="/package-centralizer"
      routerLinkActive="text-white bg-gray-800 border-l-2 border-brand-primary"
      class="w-full flex items-center h-10 text-gray-400 hover:text-white hover:bg-gray-800/50 transition-all relative group"
      [class.justify-center]="!sidebarOpen()"
      [class.px-3]="sidebarOpen()"
      [class.gap-3]="sidebarOpen()"
      aria-label="Package Centralizer">
      <svg class="w-5 h-5 shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M16.5 9.4l-9-5.19M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
        <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
        <line x1="12" y1="22.08" x2="12" y2="12"></line>
      </svg>
      @if (sidebarOpen()) {
        <span class="text-sm whitespace-nowrap overflow-hidden">Package Centralizer</span>
      } @else {
        <span class="absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-50 pointer-events-none">
          Package Centralizer
        </span>
      }
    </a>

    <a
      routerLink="/task-visualizer"
      routerLinkActive="text-white bg-gray-800 border-l-2 border-brand-primary"
      class="w-full flex items-center h-10 text-gray-400 hover:text-white hover:bg-gray-800/50 transition-all relative group"
      [class.justify-center]="!sidebarOpen()"
      [class.px-3]="sidebarOpen()"
      [class.gap-3]="sidebarOpen()"
      aria-label="Task Visualizer">
      <svg class="w-5 h-5 shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"></path>
      </svg>
      @if (sidebarOpen()) {
        <span class="text-sm whitespace-nowrap overflow-hidden">Task Visualizer</span>
      } @else {
        <span class="absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-50 pointer-events-none">
          Task Visualizer
        </span>
      }
    </a>
  </nav>

  @if (sidebarOpen()) {
    <div class="px-3 py-3 border-t border-gray-800">
      <div class="flex items-center gap-2 text-xs text-gray-500">
        <svg class="w-3 h-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <path d="M12 6v6l4 2"></path>
        </svg>
        <a target="_blank" href="https://github.com/BitSpireGmbH/toolbox"><span>{{ version() }}</span></a>
      </div>
    </div>
  }
</div>

<!-- Mobile Header -->
<div class="md:hidden fixed top-0 left-0 right-0 z-40 bg-gray-950 border-b border-gray-800 h-14 flex items-center justify-between px-4">
  <a href="/" class="flex items-center gap-2 text-white" aria-label="Home">
    <img class="w-5 h-5 shrink-0" aria-label="Home icon" alt="Home" src="assets/logo_small.webp" />
    <span class="font-semibold text-sm">.NET Toolbox</span>
  </a>
  <button
    (click)="onToggleSidebar()"
    class="p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition-all"
    [attr.aria-expanded]="sidebarOpen()"
    aria-label="Toggle navigation menu">
    <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      @if (!sidebarOpen()) {
        <path d="M3 12h18M3 6h18M3 18h18"></path>
      } @else {
        <path d="M6 18L18 6M6 6l12 12"></path>
      }
    </svg>
  </button>
</div>

<!-- Mobile Menu Overlay and Sidebar -->
@if (sidebarOpen()) {
  <div
    (click)="onCloseSidebar()"
    class="md:hidden fixed inset-0 bg-black/60 z-40 backdrop-blur-sm"
    aria-hidden="true"></div>

  <aside class="md:hidden fixed top-14 right-0 bottom-0 w-72 bg-gray-900 z-50 border-l border-gray-800 overflow-y-auto animate-slide-in">
    <nav class="py-4" aria-label="Mobile navigation">
      <div class="px-4 mb-3">
        <span class="text-xs font-semibold text-gray-500 uppercase tracking-wider">Navigation</span>
      </div>

      <a
        routerLink="/home"
        routerLinkActive="bg-brand-primary/20 text-brand-primary border-r-2 border-brand-primary"
        [routerLinkActiveOptions]="{exact: false}"
        (click)="onCloseSidebar()"
        class="flex items-center gap-3 px-4 py-3 text-gray-300 hover:bg-gray-800 hover:text-white transition-all">
        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
          <polyline points="9 22 9 12 15 12 15 22"></polyline>
        </svg>
        <span class="font-medium">Home</span>
      </a>

      <a
        routerLink="/csharp-json"
        routerLinkActive="bg-brand-primary/20 text-brand-primary border-r-2 border-brand-primary"
        (click)="onCloseSidebar()"
        class="flex items-center gap-3 px-4 py-3 text-gray-300 hover:bg-gray-800 hover:text-white transition-all">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M14 19H16C17.1046 19 18 18.1046 18 17V14.5616C18 13.6438 18.6246 12.8439 19.5149 12.6213L21.0299 12.2425C21.2823 12.1794 21.2823 11.8206 21.0299 11.7575L19.5149 11.3787C18.6246 11.1561 18 10.3562 18 9.43845V5H14"/>
          <path d="M10 5H8C6.89543 5 6 5.89543 6 7V9.43845C6 10.3562 5.37541 11.1561 4.48507 11.3787L2.97014 11.7575C2.71765 11.8206 2.71765 12.1794 2.97014 12.2425L4.48507 12.6213C5.37541 12.8439 6 13.6438 6 14.5616V19H10"/>
        </svg>
        <span class="font-medium">JSON → C#</span>
      </a>

      <a
        routerLink="/csharp-typescript"
        routerLinkActive="bg-brand-primary/20 text-brand-primary border-r-2 border-brand-primary"
        (click)="onCloseSidebar()"
        class="flex items-center gap-3 px-4 py-3 text-gray-300 hover:bg-gray-800 hover:text-white transition-all">
        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="16 18 22 12 16 6"></polyline>
          <polyline points="8 6 2 12 8 18"></polyline>
        </svg>
        <span class="font-medium">C# ↔ TypeScript</span>
      </a>

      <a
        routerLink="/middleware-designer"
        routerLinkActive="bg-brand-primary/20 text-brand-primary border-r-2 border-brand-primary"
        (click)="onCloseSidebar()"
        class="flex items-center gap-3 px-4 py-3 text-gray-300 hover:bg-gray-800 hover:text-white transition-all">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 6.878V6a2.25 2.25 0 0 1 2.25-2.25h7.5A2.25 2.25 0 0 1 18 6v.878m-12 0c.235-.083.487-.128.75-.128h10.5c.263 0 .515.045.75.128m-12 0A2.25 2.25 0 0 0 4.5 9v.878m13.5-3A2.25 2.25 0 0 1 19.5 9v.878m0 0a2.246 2.246 0 0 0-.75-.128H5.25c-.263 0-.515.045-.75.128m15 0A2.25 2.25 0 0 1 21 12v6a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 18v-6c0-.98.626-1.813 1.5-2.122" />
        </svg>

        <span class="font-medium">Middleware Designer</span>
      </a>

      <a
        routerLink="/jwt-decoder"
        routerLinkActive="bg-brand-primary/20 text-brand-primary border-r-2 border-brand-primary"
        (click)="onCloseSidebar()"
        class="flex items-center gap-3 px-4 py-3 text-gray-300 hover:bg-gray-800 hover:text-white transition-all">
        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
          <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
        </svg>
        <span class="font-medium">JWT Decoder</span>
      </a>

      <a
        routerLink="/package-centralizer"
        routerLinkActive="bg-brand-primary/20 text-brand-primary border-r-2 border-brand-primary"
        (click)="onCloseSidebar()"
        class="flex items-center gap-3 px-4 py-3 text-gray-300 hover:bg-gray-800 hover:text-white transition-all">
        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M16.5 9.4l-9-5.19M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
          <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
          <line x1="12" y1="22.08" x2="12" y2="12"></line>
        </svg>
        <span class="font-medium">Package Centralizer</span>
      </a>

      <a
        routerLink="/task-visualizer"
        routerLinkActive="bg-brand-primary/20 text-brand-primary border-r-2 border-brand-primary"
        (click)="onCloseSidebar()"
        class="flex items-center gap-3 px-4 py-3 text-gray-300 hover:bg-gray-800 hover:text-white transition-all">
        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"></path>
        </svg>
        <span class="font-medium">Task Visualizer</span>
      </a>
    </nav>

    <div class="absolute bottom-0 left-0 right-0 px-4 py-4 border-t border-gray-800 bg-gray-900">
      <div class="flex items-center justify-between text-xs text-gray-500">
        <a target="_blank" href="https://github.com/BitSpireGmbH/toolbox"><span>{{ version() }}</span></a>
        <span>© 2025 Bitspire</span>
      </div>
    </div>
  </aside>
}
